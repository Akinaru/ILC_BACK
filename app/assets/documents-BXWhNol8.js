import{k as E,r as b,o as g,d as a,e as o,g as i,y as d,A as P,B as $,h as f,i as r}from"./index-WfzvT7mn.js";const M={class:"m-5"},S=i("p",{class:"font-bold text-lg mb-4"},"Documents",-1),A={class:"flex justify-center items-center flex-col"},U={class:"mb-6 w-3/4 flex items-center justify-center flex-col"},D=i("p",{class:"font-semibold text-md mb-2 text-start w-full"},"Formulaire autorisation affichage dans les anciens étudiants",-1),B={class:"flex w-full"},F={key:3,disabled:"",class:"btn btn-primary mx-2 min-w-44 hover:scale-105 transition-all hover:opacity-70"},T={class:"mb-6 w-3/4 flex items-center justify-center flex-col"},V=i("p",{class:"font-semibold text-md mb-2 text-start w-full"},"Tableau excel des choix des cours",-1),I={class:"flex w-full"},N={key:3,disabled:"",class:"btn btn-primary mx-2 min-w-44 hover:scale-105 transition-all hover:opacity-70"},j={class:"mb-6 w-3/4 flex items-center justify-center flex-col"},q=i("p",{class:"font-semibold text-md mb-2 text-start w-full"},"Contrat pédagogique",-1),G={class:"flex w-full"},O={key:3,disabled:"",class:"btn btn-primary mx-2 min-w-44"},z={id:"confirmModal",ref:"confirmModal",class:"modal"},L={class:"modal-box"},W=i("h3",{class:"text-lg font-bold"},"Confirmer la suppression ?",-1),H={class:"py-3"},J={class:"modal-action"},R={__name:"documents",setup(K){const _=E(),s=b([]),m=b({title:"",type:""}),t=b({anciensEtudiants:{file:null,exist:!1,path:""},choixCours:{file:null,exist:!1,path:""},contratPeda:{file:null,exist:!1,path:""}});function p(l,e){m.value.title=l,m.value.type=e,document.getElementById("confirmModal").showModal()}function y(){document.getElementById("confirmModal").close()}const v=(l,e)=>{const n=l.target.files[0];n?t.value[e].file=n:t.value[e].file=null};async function x(l,e,n){const u=new FormData;if(u.append("file",n),u.append("title",l),u.append("folder",e),await f("POST",!0,s,r.apiUrl+"api/documents",u),s.value.status==200){t.value.anciensEtudiants.file=null,t.value.choixCours.file=null,t.value.contratPeda.file=null;const c={act_description:"Modification du document: "+e+"/"+l+".",acc_id:_.login,admin:1};await f("POST",!1,s,r.apiUrl+"api/action",c)}w()}async function C(l,e){y(),await f("GET",!0,s,`${r.apiUrl}api/documents/delete/admin/${l}`),s.value.status==200&&(t.value[e].exist=!1,t.value[e].file=null,t.value[e].path="")}async function w(){await f("GET",!1,s,r.apiUrl+"api/documents/checkexist/admin/auto_ancien_etu"),s.value.status==200&&(t.value.anciensEtudiants.exist=!0,t.value.anciensEtudiants.path=s.value.path),await f("GET",!1,s,r.apiUrl+"api/documents/checkexist/admin/choix_cours"),s.value.status==200&&(t.value.choixCours.exist=!0,t.value.choixCours.path=s.value.path),await f("GET",!1,s,r.apiUrl+"api/documents/checkexist/admin/contrat_peda"),s.value.status==200&&(t.value.contratPeda.exist=!0,t.value.contratPeda.path=s.value.path),k()}function k(){t.value.anciensEtudiants.file=null,t.value.choixCours.file=null,document.querySelectorAll(".file-input").forEach(e=>{e.value=""})}function h(l){const e=l.split("/"),n=e[e.length-1],u=r.apiUrl+`api/documents/get/admin/${n}`;if(n.toLowerCase().endsWith(".pdf"))window.open(u,"_blank");else{const c=document.createElement("a");c.href=u,c.download=n,document.body.appendChild(c),c.click(),document.body.removeChild(c)}}return g(w),(l,e)=>(a(),o("div",M,[S,i("div",A,[i("div",U,[D,i("div",B,[i("input",{type:"file",accept:".pdf, .xls, .xlsx",onChange:e[0]||(e[0]=n=>v(n,"anciensEtudiants")),class:"file-input file-input-bordered min-w-2xl w-full"},null,32),t.value.anciensEtudiants.file!=null?(a(),o("button",{key:0,class:"btn btn-success mx-2 hover:scale-105 transition-all hover:opacity-70",onClick:e[1]||(e[1]=n=>x("auto_ancien_etu","documents/admin",t.value.anciensEtudiants.file))},"Envoyer le fichier")):d("",!0),t.value.anciensEtudiants.exist?(a(),o("button",{key:1,class:"btn btn-primary mx-2 min-w-44 hover:scale-105 transition-all hover:opacity-70",onClick:e[2]||(e[2]=n=>h(t.value.anciensEtudiants.path))},"Voir le fichier actuel")):d("",!0),t.value.anciensEtudiants.exist?(a(),o("button",{key:2,class:"btn btn-error mx-2 min-w-32 hover:scale-105 transition-all hover:opacity-70",onClick:e[3]||(e[3]=n=>p("auto_ancien_etu","anciensEtudiants"))},"Supprimer")):(a(),o("button",F,"Aucun fichier"))])]),i("div",T,[V,i("div",I,[i("input",{type:"file",accept:".pdf, .xls, .xlsx",onChange:e[4]||(e[4]=n=>v(n,"choixCours")),class:"file-input file-input-bordered min-w-2xl w-full"},null,32),t.value.choixCours.file!=null?(a(),o("button",{key:0,class:"btn btn-success mx-2 hover:scale-105 transition-all hover:opacity-70",onClick:e[5]||(e[5]=n=>x("choix_cours","documents/admin",t.value.choixCours.file))},"Envoyer le fichier")):d("",!0),t.value.choixCours.exist?(a(),o("button",{key:1,class:"btn btn-primary mx-2 min-w-44 hover:scale-105 transition-all hover:opacity-70",onClick:e[6]||(e[6]=n=>h(t.value.choixCours.path))},"Voir le fichier actuel")):d("",!0),t.value.choixCours.exist?(a(),o("button",{key:2,class:"btn btn-error mx-2 min-w-32 hover:scale-105 transition-all hover:opacity-70",onClick:e[7]||(e[7]=n=>p("choix_cours","choixCours"))},"Supprimer")):(a(),o("button",N,"Aucun fichier"))])]),i("div",j,[q,i("div",G,[i("input",{type:"file",accept:".pdf, .xls, .xlsx",onChange:e[8]||(e[8]=n=>v(n,"contratPeda")),class:"file-input file-input-bordered min-w-2xl w-full"},null,32),t.value.contratPeda.file!=null?(a(),o("button",{key:0,class:"btn btn-success mx-2",onClick:e[9]||(e[9]=n=>x("contrat_peda","documents/admin",t.value.contratPeda.file))},"Envoyer le fichier")):d("",!0),t.value.contratPeda.exist?(a(),o("button",{key:1,class:"btn btn-primary mx-2 min-w-44",onClick:e[10]||(e[10]=n=>h(t.value.contratPeda.path))},"Voir le fichier actuel")):d("",!0),t.value.contratPeda.exist?(a(),o("button",{key:2,class:"btn btn-error mx-2 min-w-32",onClick:e[11]||(e[11]=n=>p("contrat_peda","contratPeda"))},"Supprimer")):(a(),o("button",O,"Aucun fichier"))])])]),i("dialog",z,[i("div",L,[W,i("div",H,[i("p",null,[P("Confirmez vous la suppression du fichier: "),i("strong",null,$(m.value.title),1)])]),i("div",J,[i("button",{class:"btn btn-error",onClick:y},"Annuler"),i("button",{class:"btn btn-success",onClick:e[12]||(e[12]=n=>C(m.value.title,m.value.type))},"Confirmer")])])],512)]))}};export{R as default};
