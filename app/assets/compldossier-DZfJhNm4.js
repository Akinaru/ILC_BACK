import{l as B,k as I,r as p,o as q,d as a,e as o,g as e,q as c,v as x,s as E,F as h,t as y,x as v,y as j,z as T,A as i,B as r,C as k,D as F,j as f,h as w,i as V}from"./index-WfzvT7mn.js";const O={class:"m-5 flex items-center justify-center flex-col"},L=F('<div class="w-full flex items-center justify-center flex-col py-10"><p class="py-4">Avancement des étapes actuelles:</p><ul class="steps steps-vertical lg:steps-horizontal max-w-lg"><li class="step step-neutral">Inscription</li><li class="step">Choix des vœux</li><li class="step">Arbitrage</li><li class="step">Validation</li></ul></div><p class="font-bold">Bienvenue sur votre espace personnel dédié aux relations internationales.</p><p class="font-bold">Votre dossier est incomplet,</p><p class="font-bold">veuillez remplir les informations ci-dessous pour compléter votre dossier.</p>',4),G=e("p",null,"Formulaire",-1),P={class:"form-control w-full max-w-lg"},R=e("div",{class:"label"},[e("span",{class:"label-text"},"Numéro étudiant (INE)")],-1),H={class:"form-control w-full max-w-lg"},J=e("div",{class:"label"},[e("span",{class:"label-text"},"Département")],-1),K=e("option",{disabled:"",selected:"",value:""},"Séléctionnez un département",-1),Q=["label"],W=["value"],Y={class:"form-control"},Z={class:"label cursor-pointer"},$=e("span",{class:"label-text"},"Avez-vous des aménagements aux examens ?",-1),ee={key:0,class:"form-control w-full max-w-lg"},te=e("div",{class:"label"},[e("span",{class:"label-text"},"Description (facultatif)")],-1),ne={class:"form-control"},se={class:"label cursor-pointer"},le=e("span",{class:"label-text"},"Consentez-vous à l'utilisation de votre image selon notre politique de confidentialité et de protection des données ?",-1),ae={class:"form-control"},oe={class:"label cursor-pointer"},re=e("span",{class:"label-text"},"Acceptez-vous d’apparaître dans l’annuaire des anciens étudiants conformément à notre politique de confidentialité ?",-1),ie={id:"confirmModal",ref:"confirmModal",class:"modal"},ce={class:"modal-box"},ue=e("h3",{class:"text-lg font-bold"},"Confirmer les informations",-1),de={class:"py-3"},me={key:0},pe={key:1},ve=e("strong",null,"Aucun",-1),ge={__name:"compldossier",setup(fe){const C=B(),_=I(),u=p([]),g=p([]),t=p({ine:"",department:"",amenagement:!1,consent:!1,consentancien:!0,amenagementdesc:""});async function b(){if(!t.value.ine||t.value.ine===""){f("error",{data:{error:"Veuillez renseigner le numéro étudiant (INE)."}}),d();return}else if(!t.value.department||t.value.department===""){f("error",{data:{error:"Veuillez renseigner votre département."}}),d();return}else if(!t.value.consent){f("error",{data:{error:"Votre consentement au droit à l'image est obligatoire.",message:"Veuillez vous renseigner auprès du service ILC en cas de soucis."}}),d();return}const l={acc_id:_.login,acc_studentnum:t.value.ine,dept_id:t.value.department,acc_amenagement:t.value.amenagement,acc_consent:t.value.consent};t.value.amenagement&&(l.acc_amenagementdesc=t.value.amenagementdesc),await w("PUT",!1,g,V.apiUrl+"api/account/compldossier",l),g.value.response||(_.setValidate(!0),C.push({name:"Dashboard"})),d()}function M(){document.getElementById("confirmModal").showModal()}function D(l){const s=u.value.components.flatMap(n=>n.departments).find(n=>n.dept_id===l);return s?s.dept_shortname:null}function N(l){const s=u.value.components.flatMap(n=>n.departments).find(n=>n.dept_id===l);return s?s.dept_name:null}function z(l){const s=u.value.components.flatMap(n=>n.departments).find(n=>n.dept_id===l);return s?s.dept_color:null}function d(){document.getElementById("confirmModal").close()}async function A(){await w("GET",!1,u,V.apiUrl+"api/component"),S()}function S(){t.value.ine="",t.value.amenagement=!1,t.value.consent=!1,t.value.department=document.querySelector(".select").options[0].value}return q(A),(l,s)=>(a(),o("div",O,[L,e("form",{onSubmit:T(b,["prevent"]),class:"m-5 md:w-4/6 w-full flex items-center justify-center flex-col mt-10"},[G,e("label",P,[R,c(e("input",{type:"text",placeholder:"XXXXXXXX",class:"input input-bordered w-full max-w-lg","onUpdate:modelValue":s[0]||(s[0]=n=>t.value.ine=n)},null,512),[[x,t.value.ine]])]),e("label",H,[J,c(e("select",{class:"select select-bordered","onUpdate:modelValue":s[1]||(s[1]=n=>t.value.department=n)},[K,(a(!0),o(h,null,y(u.value.components,(n,U)=>(a(),o("optgroup",{key:U,label:n.comp_name},[(a(!0),o(h,null,y(n.departments,(m,X)=>(a(),o("option",{key:X,value:m.dept_id,style:k({color:m.dept_color})},"("+r(m.dept_shortname)+") "+r(m.dept_name),13,W))),128))],8,Q))),128))],512),[[E,t.value.department]]),e("div",Y,[e("label",Z,[$,c(e("input",{type:"checkbox",class:"checkbox","onUpdate:modelValue":s[2]||(s[2]=n=>t.value.amenagement=n)},null,512),[[v,t.value.amenagement]])])]),t.value.amenagement?(a(),o("label",ee,[te,c(e("input",{type:"text",placeholder:"Description de l'aménagement",class:"input input-bordered w-full max-w-lg","onUpdate:modelValue":s[3]||(s[3]=n=>t.value.amenagementdesc=n)},null,512),[[x,t.value.amenagementdesc]])])):j("",!0),e("div",ne,[e("label",se,[le,c(e("input",{type:"checkbox",class:"checkbox","onUpdate:modelValue":s[4]||(s[4]=n=>t.value.consent=n)},null,512),[[v,t.value.consent]])])]),e("div",ae,[e("label",oe,[re,c(e("input",{type:"checkbox",class:"checkbox","onUpdate:modelValue":s[5]||(s[5]=n=>t.value.consentancien=n)},null,512),[[v,t.value.consentancien]])])]),e("div",{class:"flex items-center justify-center mt-10"},[e("button",{class:"btn btn-primary",type:"button",onClick:M},"Valider")])])],32),e("dialog",ie,[e("div",ce,[ue,e("div",de,[e("p",null,[i("Numéro étudiant : "),e("strong",null,r(t.value.ine?t.value.ine:"Aucun"),1)]),t.value.department&&t.value.department!=""?(a(),o("p",me,[i(" Département : "),e("strong",null,[e("span",{style:k({backgroundColor:z(t.value.department)}),class:"badge p-3"},r(D(t.value.department)),5),i(" "+r(N(t.value.department)),1)])])):(a(),o("p",pe,[i("Département : "),ve])),e("p",null,[i("Aménagements : "),e("strong",null,r(t.value.amenagement?"Oui":"Non"),1)]),e("p",null,[i("Consentement utilisation image : "),e("strong",null,r(t.value.consent?"Oui":"Non"),1)]),e("p",null,[i("Consentement liste anciens étudiants : "),e("strong",null,r(t.value.consentancien?"Oui":"Non"),1)])]),e("div",{class:"modal-action"},[e("button",{class:"btn btn-error",onClick:d},"Annuler"),e("button",{class:"btn btn-success",onClick:b},"Confirmer")])])],512)]))}};export{ge as default};
