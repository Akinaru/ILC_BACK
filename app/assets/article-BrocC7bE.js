import{_ as z,r as m,d as u,e as p,g as t,q as U,v as E,p as N,m as O,k as Z,c as D,o as G,b as J,B as $,z as K,C as T,f as V,x as Q,F as W,t as X,A as Y,u as j,i as c,h as x,w as tt,y as et,j as I}from"./index-B86mjc3y.js";const g=M=>(N("data-v-d9faba86"),M=M(),O(),M),ot={class:"w-full border rounded-lg shadow-sm input-bordered"},it={class:"flex flex-wrap items-center space-x-4 py-2 px-1"},nt={"data-tip":"Gras",class:"tooltip"},at=g(()=>t("svg",{fill:"currentColor",width:"19px",height:"19px",viewBox:"0 0 1920 1920",xmlns:"http://www.w3.org/2000/svg"},[t("path",{d:"M480.286 822.857h548.571c151.269 0 274.286-123.017 274.286-274.286 0-151.268-123.017-274.285-274.286-274.285H480.286v548.571Zm0 822.857H1166c151.269 0 274.286-123.017 274.286-274.285 0-151.269-123.017-274.286-274.286-274.286H480.286v548.571ZM1166 1920H206V0h822.857c302.537 0 548.572 246.034 548.572 548.571 0 134.263-48.549 257.418-128.778 352.732 159.223 96.137 265.92 270.994 265.92 470.126 0 302.537-246.034 548.571-548.571 548.571Z","fill-rule":"evenodd"})],-1)),st=[at],lt={"data-tip":"Italique",class:"tooltip flex items-center justify-center"},rt=g(()=>t("svg",{width:"22px",height:"22px",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[t("path",{d:"M10 3H20M4 21H14M15 3L9 21",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)),ct=[rt],dt={"data-tip":"SoulignÃ©",class:"tooltip flex items-center justify-center"},ut=g(()=>t("svg",{width:"24px",height:"24px",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[t("path",{d:"M4 21H20M18 4V11C18 14.3137 15.3137 17 12 17C8.68629 17 6 14.3137 6 11V4M4 3H8M16 3H20",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)),pt=[ut],_t=g(()=>t("svg",{width:"24px",height:"24px",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[t("path",{d:"M14 12C14 14.7614 11.7614 17 9 17H7C4.23858 17 2 14.7614 2 12C2 9.23858 4.23858 7 7 7H7.5M10 12C10 9.23858 12.2386 7 15 7H17C19.7614 7 22 9.23858 22 12C22 14.7614 19.7614 17 17 17H16.5",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round"})],-1)),vt=[_t],mt={"data-tip":"Aligner Ã  gauche",class:"tooltip flex items-center justify-center"},gt=g(()=>t("svg",{width:"24px",height:"24px",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[t("path",{d:"M3 8H21M3 12H21M3 16H21M3 20H15M3 4H21",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)),ft=[gt],ht={"data-tip":"Centrer",class:"tooltip flex items-center justify-center"},wt=g(()=>t("svg",{width:"24px",height:"24px",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[t("path",{d:"M3 8H21M3 12H21M3 16H21M17 20H7M3 4H21",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)),xt=[wt],bt={"data-tip":"Aligner Ã  droite",class:"tooltip flex items-center justify-center"},yt=g(()=>t("svg",{width:"24px",height:"24px",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[t("path",{d:"M3 8H21M3 12H21M3 16H21M11 20H21M3 4H21",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)),kt=[yt],Mt=g(()=>t("svg",{width:"24px",height:"24px",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[t("path",{d:"M8 6H21M8 12H21M8 18H21M3 6H3.01M3 12H3.01M3 18H3.01",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)),Ct=[Mt],Ht=g(()=>t("svg",{width:"24px",height:"24px",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[t("path",{d:"M3 5H21M10 10H21M10 14H21M3 19H21M3 9L6 12L3 15",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)),$t=[Ht],jt=g(()=>t("svg",{width:"24px",height:"24px",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[t("path",{d:"M3 5H21M14 10H3M14 14H3M3 19H21M21 9L18 12L21 15",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)),At=[jt],Lt={__name:"TextEditor",props:{text:String},emits:["update:modelValue"],setup(M,{emit:C}){const _=C,f=m("#000000"),e=d=>{document.execCommand(d)},h=()=>{const d=prompt("Entrez l'URL :");d&&document.execCommand("createLink",!1,d)},b=()=>{document.execCommand("foreColor",!1,f.value)},i=d=>{document.execCommand("justify"+d)},y=()=>{document.execCommand("insertUnorderedList")},w=()=>{document.execCommand("indent")},A=()=>{document.execCommand("outdent")},L=d=>{const r=d.target.innerHTML;_("update:modelValue",r)};return(d,r)=>(u(),p("div",ot,[t("div",it,[t("span",nt,[t("button",{type:"button",onClick:r[0]||(r[0]=v=>e("bold")),class:"editor-button hover:opacity-60 flex items-center justify-center"},st)]),t("span",lt,[t("button",{type:"button",onClick:r[1]||(r[1]=v=>e("italic")),class:"editor-button hover:opacity-60"},ct)]),t("span",dt,[t("button",{type:"button",onClick:r[2]||(r[2]=v=>e("underline")),class:"editor-button hover:opacity-60"},pt)]),U(t("input",{type:"color","onUpdate:modelValue":r[3]||(r[3]=v=>f.value=v),onChange:b,class:"editor-input tooltip","data-tip":"Couleur du texte"},null,544),[[E,f.value]]),t("span",{"data-tip":"Lien",class:"tooltip flex items-center justify-center"},[t("button",{type:"button",onClick:h,class:"editor-button hover:opacity-60"},vt)]),t("span",mt,[t("button",{type:"button",onClick:r[4]||(r[4]=v=>i("Left")),class:"editor-button hover:opacity-60"},ft)]),t("span",ht,[t("button",{type:"button",onClick:r[5]||(r[5]=v=>i("Center")),class:"editor-button hover:opacity-60"},xt)]),t("span",bt,[t("button",{type:"button",onClick:r[6]||(r[6]=v=>i("Right")),class:"editor-button hover:opacity-60"},kt)]),t("span",{"data-tip":"Liste Ã  puces",class:"tooltip flex items-center justify-center"},[t("button",{type:"button",onClick:y,class:"editor-button hover:opacity-60"},Ct)]),t("span",{"data-tip":"Augmenter l'indentation",class:"tooltip flex items-center justify-center"},[t("button",{type:"button",onClick:w,class:"editor-button hover:opacity-60"},$t)]),t("span",{"data-tip":"Diminuer l'indentation",class:"tooltip flex items-center justify-center"},[t("button",{type:"button",onClick:A,class:"editor-button hover:opacity-60"},At)])]),t("div",{ref:"editor",contenteditable:"true",onInput:L,class:"editor-content p-2 focus:outline-none inputt rounded-b-lg",id:"editorzone"},null,544)]))}},Tt=z(Lt,[["__scopeId","data-v-d9faba86"]]),Ut=t("p",{class:"text-xl font-bold"},"Articles",-1),St={class:"m-5 flex justify-center items-center flex-col"},Bt={class:"text-lg font-bold"},Dt={class:"flex items-center justify-center"},Vt={class:"form-control my-4"},It={class:"label cursor-pointer justify-start w-fit"},Et=t("span",{class:"label-text"},"Ã‰pinglÃ© ?",-1),Pt={class:"flex items-center justify-center *:mx-1"},qt={key:0,class:"btn btn-primary hover:scale-105 transition-all hover:opacity-70",type:"submit"},Ft={key:1},Rt=t("p",{class:"text-lg font-bold"},"Liste article",-1),zt={key:0,class:"flex flex-col py-5"},Nt={key:0,class:"flex flex-wrap justify-start w-full bg-red-105 gap-5"},Ot={class:"flex absolute top-0 right-0"},Zt=["onClick"],Gt=t("svg",{class:"h-5 w-5",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[t("path",{d:"M20,16v4a2,2,0,0,1-2,2H4a2,2,0,0,1-2-2V6A2,2,0,0,1,4,4H8",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2"}),t("polygon",{fill:"none",points:"12.5 15.8 22 6.2 17.8 2 8.3 11.5 8 16 12.5 15.8",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2"})],-1),Jt=[Gt],Kt=["onClick"],Qt=t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"stroke-current shrink-0 h-5 w-5",fill:"none",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1),Wt=[Qt],Xt={class:"p-2"},Yt={key:0,class:"badge badge-primary absolute top-1 left-1"},te={class:"p-4 flex flex-col justify-start h-52"},ee={class:"mb-2"},oe={class:"font-bold text-xl"},ie={class:"text-gray-600 text-sm"},ne=["innerHTML"],ae={id:"confirmModal",ref:"confirmModal",class:"modal"},se={class:"modal-box"},le=t("h3",{class:"text-lg font-bold"},"Confirmer la suppression ?",-1),re={class:"py-3"},ce={class:"modal-action"},de={key:1},ue=t("p",null,"Aucun article trouvÃ©.",-1),pe=[ue],_e={key:1,class:"flex items-center justify-center my-20"},ve=t("span",{class:"loading loading-dots loading-lg"},null,-1),me=[ve],fe={__name:"article",setup(M){const C=Z(),_=m([]),f=m([]),e=m({title:null,description:null,pinned:!1,image:null}),h=m(!1),b=m([]),i=m([]),y=m(null),w=m(null),A=a=>{if(h.value){const o=a.target.files[0];if(o){const s=new FileReader;s.onload=n=>{w.value=n.target.result},s.readAsDataURL(o),i.value.art_image=o}else w.value=null,i.value.art_image=null}else{const o=a.target.files[0];if(o){const s=new FileReader;s.onload=n=>{y.value=n.target.result},s.readAsDataURL(o),e.value.image=o}else y.value=null,e.value.image=null}},L=D(()=>y.value?y.value:`${c.apiUrl}images/no_image.jpg`),d=D(()=>w.value?w.value:i.value.art_image?`${c.apiUrl}api/article/image/${i.value.art_id}`:`${c.apiUrl}images/no_image.jpg`);function r(a){b.value=a,document.getElementById("confirmModal").showModal()}function v(){document.getElementById("confirmModal").close()}async function P(){if(e.value.title==null){I("error",{data:{error:"Vous devez mettre un titre Ã  votre article.",message:"Ajout de l'article annulÃ©."}});return}if(e.value.art_description==null){I("error",{data:{error:"Vous devez mettre une description Ã  votre article.",message:"Ajout de l'article annulÃ©."}});return}const a=S(e.value.art_description),o={art_title:e.value.title,art_description:a,art_pin:e.value.pinned};var s=m();if(await x("POST",!0,s,c.apiUrl+"api/article",o),s.value.status==201){if(e.value.image!=null)try{const l=new FormData;l.append("image",e.value.image),l.append("fileName","img_art_"+s.value.article.art_id),l.append("filePath","private/images/articles"),l.append("articleId",s.value.article.art_id),await x("POST",!0,_,c.apiUrl+"api/image/upload",l)}catch(l){console.log("Erreur ajout image: "+l)}const n={act_description:"Ajout de l'article "+s.value.article.art_title+".",acc_id:C.login,art_id:s.value.article.art_id};await x("POST",!1,s,c.apiUrl+"api/action",n),await H()}e.value.title="",e.value.art_description="",e.value.pinned=!1,e.value.image=null,y.value=null}function S(a){const s=new DOMParser().parseFromString(a,"text/html"),n=s.body.getElementsByTagName("*");for(let l of n){l.style.backgroundColor&&(l.style.backgroundColor="");const k=l.style.color;(k==="black"||k==="white"||k==="#000000"||k==="#ffffff")&&(l.style.color="")}return s.body.innerHTML}async function q(a,o){if(v(),await x("DELETE",!0,_,c.apiUrl+"api/article/deletebyid/"+o),_.value.status==202){const s={act_description:"Suppression de l'article "+a+".",acc_id:C.login,art_id:o};await x("POST",!1,_,c.apiUrl+"api/action",s)}await H()}function F(a){i.value.art_id=a.art_id,i.value.art_title=a.art_title,i.value.art_description=a.art_description,i.value.art_pin=a.art_pin,i.value.art_image=a.art_image;const o=document.querySelector(".editor-content");o.innerHTML=i.value.art_description,h.value=!0,e.value.title=i.value.art_title,e.value.pinned=i.value.art_pin,window.scrollTo({top:120,behavior:"smooth"}),a.art_image?w.value=`${c.apiUrl}api/article/image/${a.art_id}`:w.value=`${c.apiUrl}images/no_image.jpg`}function B(){h.value=!1,i.value={},e.value.title="",e.value.art_description="",e.value.pinned=!1,e.value.image=null,y.value=null,w.value=null;const a=document.querySelector(".editor-content");a.innerHTML=""}async function R(){const a=document.querySelector(".editor-content"),o=S(a.innerHTML),s={art_id:i.value.art_id,art_title:e.value.title,art_pin:e.value.pinned,art_description:o};if(await x("PUT",!0,_,c.apiUrl+"api/article",s),_.value.status===200){if(console.log(i.value.art_image),i.value.art_image)try{if(i.value.art_image instanceof File){const l=new FormData;l.append("image",i.value.art_image),l.append("fileName","img_art_"+i.value.art_id),l.append("filePath","private/images/articles"),l.append("articleId",i.value.art_id),await x("POST",!0,_,c.apiUrl+"api/image/upload",l)}}catch(l){console.log("Erreur ajout image: "+l)}const n={act_description:"Modification de l'article "+i.value.art_title+".",acc_id:C.login,art_id:i.value.art_id};await x("POST",!1,_,c.apiUrl+"api/action",n),await H(),B()}}async function H(){await x("GET",!1,f,c.apiUrl+"api/article"),h.value=!1}return G(H),(a,o)=>{const s=J("RouterLink");return u(),p("div",null,[Ut,t("div",St,[t("p",Bt,$(h.value?"Modifier article":"Ajout article"),1),t("form",{onSubmit:K(P,["prevent"]),class:"w-4/5 *:my-2",enctype:"multipart/form-data"},[t("div",Dt,[t("div",{style:T({backgroundImage:`url(${h.value?d.value:L.value})`}),class:"bg-cover bg-center w-3/5 h-72 mb-4"},null,4)]),t("input",{type:"file",onChange:A,name:"image",accept:"image/*",class:"file-input file-input-bordered w-full mb-4"},null,32),U(t("input",{type:"text",placeholder:"Titre","onUpdate:modelValue":o[0]||(o[0]=n=>e.value.title=n),class:"input input-bordered w-full mb-4"},null,512),[[E,e.value.title]]),V(Tt,{modelValue:e.value.art_description,"onUpdate:modelValue":o[1]||(o[1]=n=>e.value.art_description=n)},null,8,["modelValue"]),t("div",Vt,[t("label",It,[U(t("input",{type:"checkbox",class:"checkbox mr-2","onUpdate:modelValue":o[2]||(o[2]=n=>e.value.pinned=n)},null,512),[[Q,e.value.pinned]]),Et])]),t("div",Pt,[h.value?(u(),p("div",Ft,[t("button",{class:"btn btn-success mr-1",type:"button",onClick:R},"Enregistrer les modifications"),t("button",{class:"btn btn-neutral ml-1",type:"button",onClick:B},"Annuler les modifications")])):(u(),p("button",qt,"Ajouter l'article"))])],32)]),t("div",null,[Rt,f.value&&f.value.articles?(u(),p("div",zt,[f.value.count>0?(u(),p("div",Nt,[(u(!0),p(W,null,X(f.value.articles,(n,l)=>(u(),p("div",{key:l,class:"relative bg-base-300 w-80 md:w-110 h-96 transition-all duration-100 ease-in-out drop-shadow-lg hover:scale-105"},[t("div",Ot,[t("label",{class:"hover:opacity-70 hover:cursor-pointer bg-base-300 flex items-center justify-center p-5",onClick:k=>F(n)},Jt,8,Zt),t("button",{class:"hover:opacity-70 p-5 hover:cursor-pointer bg-base-300",onClick:k=>r(n)},Wt,8,Kt)]),V(s,{to:{name:"Article",params:{art_id:n.art_id}}},{default:tt(()=>[t("div",Xt,[t("div",{style:T({backgroundImage:`url(${n.art_image?j(c).apiUrl+"api/article/image/"+n.art_id:j(c).apiUrl+"images/no_image.jpg"})`}),class:"bg-cover bg-center w-full h-48"},null,4)]),n.art_pin?(u(),p("span",Yt,"ðŸ“ŒÃ‰pinglÃ©")):et("",!0),t("div",te,[t("div",ee,[t("p",oe,$(n.art_title),1),t("p",ie,"DerniÃ¨re modif: "+$(n.art_lastmodif),1)]),t("div",{class:"overflow-hidden text-sm text-gray-700 max-h-24",innerHTML:n.art_description},null,8,ne)])]),_:2},1032,["to"])]))),128)),t("dialog",ae,[t("div",se,[le,t("div",re,[t("p",null,[Y("Confirmez vous la supression de l'article: "),t("strong",null,$(b.value.art_title),1)]),t("div",{style:T({backgroundImage:`url(${b.value.art_image?j(c).apiUrl+"api/article/image/"+b.value.art_id:j(c).apiUrl+"images/no_image.jpg"})`}),class:"bg-cover bg-center w-full h-48 my-2"},null,4)]),t("div",ce,[t("button",{class:"btn btn-error",onClick:v},"Annuler"),t("button",{class:"btn btn-success",onClick:o[3]||(o[3]=n=>q(b.value.art_title,b.value.art_id))},"Confirmer")])])],512)])):(u(),p("div",de,pe))])):(u(),p("div",_e,me))])])}}};export{fe as default};
