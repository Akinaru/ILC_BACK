import{k as de,G as ue,r as c,o as ne,H as pe,a as _e,c as ve,b as me,d as s,e as a,g as t,u as w,I as E,y as d,B as r,A as fe,F as A,t as V,f as D,w as oe,h as u,i as p,C as re,E as ge,V as he,L as xe}from"./index-B86mjc3y.js";import{n as ye}from"./notfound-CjiIzAGP.js";const be={key:0},we={key:0},ke={class:"flex justify-end pb-20"},Ce=t("button",{class:"btn btn-primary"},null,-1),Le=[Ce],je={class:"flex items-center flex-col text-xl md:text-2xl"},Ue={class:"bg-base-300 max-w-lg flex justify-start items-center flex-col p-10 rounded-xl"},Ee={class:"relative inline-block"},Ae={key:0,class:"absolute inset-0 flex items-center justify-center text-black text-2xl font-bold bg-white select-none"},Ve={class:"flex items-center flex-col my-20 px-4"},De={class:"text-center"},Se={class:"font-bold"},Be=t("p",{class:"pt-5"},"Les départements disponibles pour cet accord:",-1),qe={class:"flex items-center flex-wrap"},ze={key:0,class:"flex flex-row items-center transition-all duration-100 ease-in-out pt-3 overflow-x-auto"},Ge={key:1},Ie=t("p",{class:"p-3 m-1"},"Aucun département",-1),Ne=[Ie],Te={class:"pt-5 text-center"},$e={key:0,class:"my-5 w-full max-w-150 text-center"},Fe=["href"],Re=t("p",{class:"flex items-start w-full py-2"},"Autres accords qui pourraient vous plaire:",-1),We={class:"bg-base-300 w-full h-64 overflow-x-auto whitespace-nowrap flex items-center text-sm"},Me={class:"flex justify-between"},Pe={class:"relative inline-block"},He={key:0,class:"absolute inset-0 flex items-center justify-center text-black text-2xl font-bold bg-white select-none"},Je={key:0,class:"flex items-start justify-start flex-wrap ml-2"},Ke={key:1},Oe=t("p",null,"Aucun département",-1),Qe=[Oe],Xe={class:"font-bold break-words whitespace-normal text-xl"},Ye=t("span",{class:"absolute inset-0 flex items-center justify-center text-xl font-bold opacity-0 group-hover:opacity-100 transition-opacity duration-200 ease-in-out bg-opacity-75"},"Voir plus",-1),Ze={key:1,class:"h-full min-h-screen flex flex-col justify-center items-center"},et=t("p",{class:"flex font-bold items-center justify-center text-xl md:text-2xl pb-10"},"Accord introuvable...",-1),tt=t("button",{class:"btn btn-primary"},"Revenir à l'accueil",-1),st={class:"flex flex-col items-center space-y-4"},at={key:1},rt={__name:"accord",setup(it){const l=de(),S=ue(),e=c([]),k=c(!1),B=c([]),C=c([]),_=c([]),L=c([]);async function q(){var v,m,f,g,h,x,y,b;k.value=!1,await u("GET",!1,e,p.apiUrl+"api/agreement/getbyid/"+S.params.agree_id),l.isLogged&&await u("GET",!1,_,p.apiUrl+"api/favoris/getbylogin/"+l.login);const o={};l.isLogged()&&(await u("GET",!1,C,p.apiUrl+"api/account/getbylogin/"+l.login),o.dept_id=C.value.department?C.value.department.dept_id:null);let i=p.apiUrl+"api/agreement/random?";o.dept_id&&(i+="dept_id="+o.dept_id+"&"),o.dept_id&&(e.value.agree_id&&(i+="agree_id="+e.value.agree_id+"&"),e.value.university&&e.value.university.univ_id&&(i+="univ_id="+e.value.university.univ_id)),await u("GET",!0,B,i),document.title=`ILC - ${((m=(v=e.value.agreement)==null?void 0:v.university)==null?void 0:m.univ_name)??"Université indisponible"} (${((g=(f=e.value.agreement)==null?void 0:f.partnercountry)==null?void 0:g.parco_name)??"Pays indisponible"} [${((x=(h=e.value.agreement)==null?void 0:h.isced)==null?void 0:x.isc_code)??"??"} - ${((b=(y=e.value.agreement)==null?void 0:y.isced)==null?void 0:b.isc_name)??"Isced indisponible"}])`,k.value=!0}function z(o){return _.value.favoris.some(i=>i.acc_id===l.login&&i.agree_id===o)}async function le(o){if(z(o))await u("delete",!0,L,p.apiUrl+"api/favoris/delete/"+l.login+"/"+o),_.value.favoris=_.value.favoris.filter(i=>!(i.acc_id===l.login&&i.agree_id===o));else{const i={acc_id:l.login,agree_id:o};await u("post",!0,L,p.apiUrl+"api/favoris",i),L.value.status==201&&_.value.favoris.push({acc_id:l.login,agree_id:o})}}ne(q),pe(()=>S.params.agree_id,()=>{q()});const G=c(window.innerWidth),j=()=>{G.value=window.innerWidth};ne(()=>{window.addEventListener("resize",j),j()}),_e(()=>{window.removeEventListener("resize",j)});const I=ve(()=>Math.min(Math.max(G.value*.6,200),500));return(o,i)=>{var m,f,g,h,x,y,b,N,T,$,F,R,W,M,P,H,J,K,O,Q;const v=me("RouterLink");return k.value?(s(),a("div",be,[e.value&&((m=e.value.agreement)!=null&&m.agree_id)?(s(),a("div",we,[t("div",ke,[w(l).isLogged()&&w(l).isStudent()?(s(),a("div",{key:0,onClick:i[0]||(i[0]=n=>le(e.value.agree_id)),class:E(["w-fit group p-2 flex items-center justify-center hover:cursor-pointer hover:scale-105 transition-all",{"hover:opacity-60":z(e.value.agree_id)}])},Le,2)):d("",!0)]),t("div",je,[t("div",Ue,[t("span",Ee,[t("span",{class:E(["fi text-8xl transition-all duration-100 ease-in-out","fi-"+(((g=(f=e.value.agreement)==null?void 0:f.partnercountry)==null?void 0:g.parco_code)||"")])},null,2),(x=(h=e.value.agreement)==null?void 0:h.partnercountry)!=null&&x.parco_code?d("",!0):(s(),a("span",Ae,"?"))])]),t("div",Ve,[t("p",De,[t("span",Se,r(((b=(y=e.value.agreement)==null?void 0:y.university)==null?void 0:b.univ_name)||"Université indisponible"),1),fe(" à "+r(((T=(N=e.value.agreement)==null?void 0:N.university)==null?void 0:T.univ_city)||"Ville indisponible")+" en ("+r(((F=($=e.value.agreement)==null?void 0:$.partnercountry)==null?void 0:F.parco_name)||"Pays indisponible")+") ",1)]),Be,t("div",qe,[((W=(R=e.value.agreement)==null?void 0:R.departments)==null?void 0:W.length)>0?(s(),a("div",ze,[(s(!0),a(A,null,V((M=e.value.agreement)==null?void 0:M.departments,(n,U)=>(s(),a("div",{key:U},[n.pivot.deptagree_valide?(s(),a("p",{key:0,class:"transition-all duration-100 ease-in-out md:p-3 min-w-11 p-1 ml-0 m-1 font-bold drop-shadow-lg select-none text-lg",style:re({backgroundColor:n.dept_color})},r(n.dept_shortname),5)):d("",!0)]))),128))])):(s(),a("div",Ge,Ne))]),t("p",Te,r(((H=(P=e.value.agreement)==null?void 0:P.isced)==null?void 0:H.isc_code)||"Code ISCED indisponible")+" - "+r(((K=(J=e.value.agreement)==null?void 0:J.isced)==null?void 0:K.isc_name)||"Nom ISCED indisponible"),1),e.value.agreement&&e.value.agreement.agree_description?(s(),a("p",$e,r(e.value.agreement.agree_description),1)):d("",!0),(O=e.value.agreement)!=null&&O.agree_lien?(s(),a("a",{key:1,target:"_blank",href:(Q=e.value.agreement)==null?void 0:Q.agree_lien,class:"pt-5 hover:opacity-80 text-blue-700 hover:cursor-pointer hover:underline"},"Cliquez ici pour accéder au site de l'université",8,Fe)):d("",!0)]),Re,t("div",We,[(s(!0),a(A,null,V(B.value.agreements,(n,U)=>(s(),ge(v,{to:{name:"Accord",params:{agree_id:n.agree_id}},key:U,class:"relative group hover:opacity-60 hover:cursor-pointer bg-base-100 rounded-lg p-4 m-2 min-w-80 w-80 h-52 drop-shadow-lg flex flex-col justify-between transition-all hover:scale-102"},{default:oe(()=>{var X,Y,Z,ee,te,se,ae;return[t("div",Me,[t("div",null,[t("span",Pe,[t("span",{class:E(["fi text-xl xl:text-5xl transition-all duration-100 ease-in-out","fi-"+(((X=n.partnercountry)==null?void 0:X.parco_code)||"")])},null,2),(Y=n.partnercountry)!=null&&Y.parco_code?d("",!0):(s(),a("span",He,"?"))])]),n.departments.length>0?(s(),a("div",Je,[(s(!0),a(A,null,V(n.departments,(ie,ce)=>(s(),a("div",{class:"font-bold text-xxs p-1",style:re({backgroundColor:ie.dept_color}),key:ce},r(ie.dept_shortname),5))),128))])):(s(),a("div",Ke,Qe))]),t("div",null,[t("p",Xe,r(((Z=n.university)==null?void 0:Z.univ_name)||"Université indisponible"),1),t("p",null,r(((ee=n.university)==null?void 0:ee.univ_city)||"Ville indisponible")+" ("+r(((te=n.partnercountry)==null?void 0:te.parco_name)||"Pays indisponible")+") "+r((se=n.isced)!=null&&se.isc_code?" - ":"")+" "+r(((ae=n.isced)==null?void 0:ae.isc_code)||""),1)]),Ye]}),_:2},1032,["to"]))),128))])])])):(s(),a("div",Ze,[et,D(v,{to:{name:"Accueil"},class:"hover:opacity-80 transition-all hover:scale-105"},{default:oe(()=>[tt]),_:1}),t("div",st,[D(w(he),{animationData:w(ye),height:I.value,width:I.value},null,8,["animationData","height","width"])])]))])):(s(),a("div",at,[D(xe)]))}}};export{rt as default};
