import{_ as Q,k as X,r as f,o as Z,b as ee,d as l,e as i,g as e,z as j,q as b,v as w,s as $,F as A,t as E,B as u,y as M,I as L,j as D,h as c,i as m,f as te,w as ae,A as oe,p as ne,m as se}from"./index-B86mjc3y.js";const n=S=>(ne("data-v-632134fa"),S=S(),se(),S),le=n(()=>e("p",{class:"text-xl font-bold"},"Évènements",-1)),ie={class:"m-5 flex justify-center items-center flex-col"},de=n(()=>e("p",{class:"text-lg font-bold"},"Ajout évènement",-1)),re={class:"form-control w-full"},ue=n(()=>e("div",{class:"label"},[e("span",{class:"label-text"},"Thématique")],-1)),ce=n(()=>e("option",{disabled:"",selected:""},"Selectionnez une thématique",-1)),me=["value"],ve=n(()=>e("option",{value:"addNew"},"Créer une thématique",-1)),_e={key:0,class:"form-control w-full"},pe=n(()=>e("div",{class:"label"},[e("span",{class:"label-text"},"Nom thématique")],-1)),he={class:"badge badge-warning mt-3"},fe={class:"form-control w-full"},be=n(()=>e("div",{class:"label"},[e("span",{class:"label-text"},"Date de l'évènement")],-1)),we=n(()=>e("div",{class:"flex items-center justify-center *:mx-1"},[e("button",{class:"btn btn-primary hover:scale-105 transition-all hover:opacity-70",type:"submit"},"Ajouter l'évènement")],-1)),ge=n(()=>e("p",{class:"text-lg font-bold"},"Liste des thématiques",-1)),ye={key:0,class:"flex flex-wrap gap-4 py-5"},xe={class:"badge badge-warning mr-2"},ke=["onClick"],qe=n(()=>e("svg",{class:"h-5 w-5 text-gray-600",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[e("path",{d:"M20,16v4a2,2,0,0,1-2,2H4a2,2,0,0,1-2-2V6A2,2,0,0,1,4,4H8",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2"}),e("polygon",{fill:"none",points:"12.5 15.8 22 6.2 17.8 2 8.3 11.5 8 16 12.5 15.8",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2"})],-1)),Me=[qe],De=["onClick"],Te=n(()=>e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"stroke-current h-5 w-5 text-red-500",fill:"none",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)),Ce=[Te],Se={key:0,class:"flex items-center my-2 bg-base-300 w-fit rounded-lg shadow-lg p-3"},Ae=n(()=>e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"stroke-current h-5 w-5 text-green-500",fill:"none",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})],-1)),Ee=[Ae],Ue=n(()=>e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"stroke-current h-5 w-5 text-red-500",fill:"none",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)),je=[Ue],Ve=n(()=>e("p",{class:"text-lg font-bold"},"Liste des évènements",-1)),Be={key:0,class:"flex flex-col py-5 space-y-4"},ze={key:0},$e={class:"w-full p-4 transition-opacity"},Le={class:"flex justify-between items-center"},Ie={class:"flex flex-col space-y-2"},Ne={class:"text-xl font-bold"},Pe={key:0,class:"badge badge-warning"},Oe={class:"truncate max-h-20 overflow-hidden whitespace-normal text-sm text-gray-700 mt-2"},Fe=["onClick"],He=n(()=>e("svg",{class:"h-5 w-5 text-gray-600",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[e("path",{d:"M20,16v4a2,2,0,0,1-2,2H4a2,2,0,0,1-2-2V6A2,2,0,0,1,4,4H8",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2"}),e("polygon",{fill:"none",points:"12.5 15.8 22 6.2 17.8 2 8.3 11.5 8 16 12.5 15.8",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2"})],-1)),Ge=[He],Re=["onClick"],We=n(()=>e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"stroke-current shrink-0 h-5 w-5 text-red-500",fill:"none",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)),Ye=[We],Je={key:1},Ke=n(()=>e("p",null,"Aucun évènement trouvé.",-1)),Qe=[Ke],Xe={key:1,class:"flex items-center justify-center my-20"},Ze=n(()=>e("span",{class:"loading loading-dots loading-lg"},null,-1)),et=[Ze],tt=n(()=>e("input",{type:"checkbox",id:"modal_modif",class:"modal-toggle"},null,-1)),at={class:"modal modal-bottom sm:modal-middle",role:"dialog"},ot={class:"modal-box"},nt={class:"font-bold text-lg"},st={class:"form-control w-full"},lt=n(()=>e("div",{class:"label"},[e("span",{class:"label-text"},"Titre")],-1)),it={class:"form-control w-full"},dt=n(()=>e("div",{class:"label"},[e("span",{class:"label-text"},"Thématique")],-1)),rt=n(()=>e("option",{disabled:"",value:""},"Sélectionnez une thématique",-1)),ut=["value"],ct={class:"form-control w-full"},mt=n(()=>e("div",{class:"label"},[e("span",{class:"label-text"},"Date")],-1)),vt={class:"form-control w-full"},_t=n(()=>e("div",{class:"label"},[e("span",{class:"label-text"},"Description")],-1)),pt=n(()=>e("div",{class:"modal-action"},[e("label",{for:"modal_modif",class:"btn"},"Annuler"),e("button",{type:"submit"},[e("label",{for:"modal_modif",class:"btn btn-success"},"Enregistrer")])],-1)),ht=n(()=>e("input",{type:"checkbox",id:"modal_modif_them",class:"modal-toggle"},null,-1)),ft={class:"modal modal-bottom sm:modal-middle",role:"dialog"},bt={class:"modal-box"},wt={class:"font-bold text-lg"},gt={class:"form-control w-full"},yt=n(()=>e("div",{class:"label"},[e("span",{class:"label-text"},"Nom")],-1)),xt={class:"badge badge-warning mt-3"},kt=n(()=>e("div",{class:"modal-action"},[e("label",{for:"modal_modif_them",class:"btn"},"Annuler"),e("button",{type:"submit"},[e("label",{for:"modal_modif_them",class:"btn btn-success"},"Enregistrer")])],-1)),qt={id:"confirmModalThematique",ref:"confirmModalThematique",class:"modal"},Mt={class:"modal-box"},Dt=n(()=>e("h3",{class:"text-lg font-bold"},"Confirmer la suppression ?",-1)),Tt={class:"py-3"},Ct={key:0},St=n(()=>e("p",null,"Confirmez vous la supression de la thématique: ",-1)),At=[St],Et={key:1},Ut={class:"badge badge-warning mt-3"},jt={key:0,class:"modal-action"},Vt={key:1,class:"modal-action"},Bt={id:"confirmModalEvenement",ref:"confirmModalEvenement",class:"modal"},zt={class:"modal-box"},$t=n(()=>e("h3",{class:"text-lg font-bold"},"Confirmer la suppression ?",-1)),Lt={class:"py-3"},It=n(()=>e("p",null,"Confirmez vous la suppression de l'événement:",-1)),Nt={class:"mt-3"},Pt={key:0,class:"badge badge-warning"},Ot={class:"modal-action"},Ft={__name:"evenement",setup(S){const q=X(),v=f([]),g=f([]),T=f([]),s=f({name:"",description:"",datetime:"",thematique:"",newthem:{name:""}}),d=f([]),_=f([]),x=f([]),y=f([]),p=f({open:!1,name:""});async function I(){if(s.value.name==""){D("error",{data:{error:"Vous devez mettre un titre d'événement.",message:"Ajout de l'événement annulé."}});return}if(s.value.description==""){D("error",{data:{error:"Vous devez mettre une description.",message:"Ajout de l'événement annulé."}});return}if(s.value.datetime==""){D("error",{data:{error:"Vous devez mettre une date.",message:"Ajout de l'événement annulé."}});return}const o={evt_name:s.value.name,evt_description:s.value.description,evt_datetime:s.value.datetime};if(s.value.thematique!=="addNew")o.evthm_id=s.value.thematique;else{if(s.value.newthem.name==""){D("error",{data:{error:"Vous devez choisir un nom de thématique.",message:"Ajout de l'événement annulé."}});return}o.newthem={evthm_name:s.value.newthem.name}}if(o.evthm_id=="Selectionnez une thématique"){D("error",{data:{error:"Vous devez choisir une thématique.",message:"Ajout de l'événement annulé."}});return}var t=f();if(await c("POST",!0,t,m.apiUrl+"api/event",o),await k(),t.value.status==201){const r={act_description:"Ajout de l'évènement "+t.value.event.evt_name+" pour le "+t.value.event.evt_datetime,acc_id:q.login,evt_id:t.value.event.evt_id};await c("POST",!1,t,m.apiUrl+"api/action",r)}V()}async function N(){if(p.value.name==""){D("error",{data:{error:"Vous devez mettre un nom de thématique.",message:"Ajout de la thématique annulé."}});return}const o={evthm_name:p.value.name};var t=f();if(await c("POST",!0,t,m.apiUrl+"api/eventtheme",o),t.value.status==201){p.value={open:!1,name:""};const r={act_description:"Ajout de la thématique "+o.evthm_name+".",acc_id:q.login,evt_id:1};await c("POST",!1,t,m.apiUrl+"api/action",r),await k()}}function P(o){x.value=o,x.value.canDelete=!(F(o.evthm_id)>0),document.getElementById("confirmModalThematique").showModal()}function O(o){y.value=o,document.getElementById("confirmModalEvenement").showModal()}function C(){document.getElementById("confirmModalThematique").close(),document.getElementById("confirmModalEvenement").close()}function F(o){return!g.value||!g.value.events?0:g.value.events.filter(r=>r.theme&&r.theme.evthm_id===o).length}async function H(o,t){if(C(),await c("DELETE",!0,v,m.apiUrl+"api/eventtheme/deletebyid/"+t),v.value.status==202){const r={act_description:"Suppression de la thématique "+o+".",acc_id:q.login,evt_id:t};await c("POST",!1,v,m.apiUrl+"api/action",r)}await k()}async function G(o,t){if(C(),await c("DELETE",!0,v,m.apiUrl+"api/event/deletebyid/"+t),v.value.status==202){const r={act_description:"Suppression de l'évènement "+o+".",acc_id:q.login,evt_id:t};await c("POST",!1,v,m.apiUrl+"api/action",r)}await k()}function R(o){d.value.evt_id=o.evt_id,d.value.evt_name=o.evt_name,d.value.evthm_id=o.theme.evthm_id,d.value.evt_description=o.evt_description,d.value.evt_datetime=Y(o.evt_datetime)}function W(o){_.value.evthm_id=o.evthm_id,_.value.evthm_name=o.evthm_name}function Y(o){const t=new Date(o),r=t.getFullYear(),a=String(t.getMonth()+1).padStart(2,"0"),h=String(t.getDate()).padStart(2,"0");return`${r}-${a}-${h}`}async function J(){const o={evthm_id:_.value.evthm_id,evthm_name:_.value.evthm_name};if(await c("PUT",!0,v,m.apiUrl+"api/eventtheme",o),v.value.status==200){const t={act_description:"Modification de la thématique "+_.value.evthm_name+".",acc_id:q.login,evt_id:_.value.evthm_id};await c("POST",!1,v,m.apiUrl+"api/action",t)}k()}async function K(){const o={evt_id:d.value.evt_id,evt_name:d.value.evt_name,evthm_id:d.value.evthm_id,evt_description:d.value.evt_description,evt_datetime:d.value.evt_datetime};if(await c("PUT",!0,v,m.apiUrl+"api/event",o),v.value.status==200){const t={act_description:"Modification de l'évènement "+d.value.evt_name+".",acc_id:q.login,evt_id:d.value.evt_id};await c("POST",!1,v,m.apiUrl+"api/action",t)}k()}function V(){s.value.name="",s.value.description="",s.value.datetime="",s.value.thematique=document.querySelector(".select").options[0].value}function B(o){const t=new Date(o),r=String(t.getDate()).padStart(2,"0"),a=String(t.getMonth()+1).padStart(2,"0"),h=t.getFullYear();return`${r}/${a}/${h}`}function z(o){const t=new Date(o),r=new Date;return t.toDateString()===r.toDateString()?"badge-primary":t>=r?"badge-success":"badge-error"}async function k(){await c("GET",!1,g,m.apiUrl+"api/event"),await c("GET",!1,T,m.apiUrl+"api/eventtheme"),V()}return Z(k),(o,t)=>{const r=ee("RouterLink");return l(),i("div",null,[e("div",null,[le,e("div",ie,[de,e("form",{onSubmit:j(I,["prevent"]),class:"w-2/5 *:my-2",enctype:"multipart/form-data"},[b(e("input",{type:"text",placeholder:"Titre","onUpdate:modelValue":t[0]||(t[0]=a=>s.value.name=a),class:"input input-bordered w-full"},null,512),[[w,s.value.name]]),e("label",re,[ue,b(e("select",{class:"select select-bordered w-full","onUpdate:modelValue":t[1]||(t[1]=a=>s.value.thematique=a)},[ce,(l(!0),i(A,null,E(T.value,(a,h)=>(l(),i("option",{key:h,value:a.evthm_id},u(a.evthm_name),9,me))),128)),ve],512),[[$,s.value.thematique]]),s.value.thematique=="addNew"?(l(),i("label",_e,[pe,b(e("input",{type:"text",class:"input input-bordered w-full","onUpdate:modelValue":t[2]||(t[2]=a=>s.value.newthem.name=a),placeholder:"Nom de la thématique"},null,512),[[w,s.value.newthem.name]]),e("span",he,u(s.value.newthem.name?s.value.newthem.name:"Aperçu de la thématique"),1)])):M("",!0)]),e("label",fe,[be,b(e("input",{type:"date",class:"input input-bordered w-full","onUpdate:modelValue":t[3]||(t[3]=a=>s.value.datetime=a)},null,512),[[w,s.value.datetime]])]),b(e("textarea",{class:"textarea w-full textarea-bordered h-48",placeholder:"Description","onUpdate:modelValue":t[4]||(t[4]=a=>s.value.description=a)},null,512),[[w,s.value.description]]),we],32)]),e("div",null,[ge,T.value?(l(),i("div",ye,[(l(!0),i(A,null,E(T.value,(a,h)=>(l(),i("div",{key:h,class:"flex items-center my-2 bg-base-300 w-fit rounded-lg shadow-lg p-3"},[e("span",xe,u(a.evthm_name),1),e("label",{for:"modal_modif_them",class:"hover:opacity-60 cursor-pointer flex items-center p-2",onClick:U=>W(a)},Me,8,ke),e("button",{class:"hover:opacity-60 p-2 cursor-pointer",onClick:U=>P(a)},Ce,8,De)]))),128)),p.value.open?(l(),i("div",Se,[b(e("input",{type:"text",class:"badge badge-warning text-black custom-placeholder-input outline-none","onUpdate:modelValue":t[5]||(t[5]=a=>p.value.name=a),placeholder:"Écrivez la thématique ici"},null,512),[[w,p.value.name]]),e("button",{class:"hover:opacity-60 p-2 cursor-pointer",onClick:t[6]||(t[6]=a=>N())},Ee),e("button",{class:"hover:opacity-60 p-2 cursor-pointer",onClick:t[7]||(t[7]=a=>p.value.open=!p.value.open)},je)])):M("",!0),p.value.open?M("",!0):(l(),i("div",{key:1,class:"flex items-center my-2 bg-base-300 w-fit rounded-lg shadow-lg p-3 hover:opacity-70 transition-all cursor-pointer hover:scale-105",onClick:t[8]||(t[8]=a=>p.value.open=!p.value.open)},"Ajouter"))])):M("",!0)]),e("div",null,[Ve,g.value&&g.value.events?(l(),i("div",Be,[g.value.count>0?(l(),i("div",ze,[(l(!0),i(A,null,E(g.value.events,(a,h)=>(l(),i("div",{key:h,class:"flex bg-base-300 my-3 w-full max-w-full overflow-hidden rounded-lg shadow-lg"},[te(r,{class:"hover:opacity-60 transition-opacity flex my-1 w-full",to:{name:"EvenementDetail",params:{evt_id:a.evt_id}}},{default:ae(()=>[e("div",$e,[e("div",Le,[e("div",Ie,[e("p",Ne,[e("span",{class:L([z(a.evt_datetime),"badge badge-info mr-2"])},u(B(a.evt_datetime)),3),oe(" "+u(a.evt_name),1)]),a.theme?(l(),i("span",Pe,u(a.theme.evthm_name),1)):M("",!0)])]),e("pre",Oe,"                                        "+u(a.evt_description)+`
                                    `,1)])]),_:2},1032,["to"]),e("label",{for:"modal_modif",class:"hover:opacity-60 cursor-pointer bg-base-300 flex items-center justify-center p-5",onClick:U=>R(a)},Ge,8,Fe),e("button",{class:"hover:opacity-60 p-5 cursor-pointer bg-base-300",onClick:U=>O(a)},Ye,8,Re)]))),128))])):(l(),i("div",Je,Qe))])):(l(),i("div",Xe,et))])]),e("div",null,[tt,e("div",at,[e("div",ot,[e("h3",nt,"Modification de l'évènement "+u(d.value.evt_id),1),e("form",{onSubmit:j(K,["prevent"]),class:"w-full"},[e("label",st,[lt,b(e("input",{type:"text",class:"input input-bordered w-full","onUpdate:modelValue":t[9]||(t[9]=a=>d.value.evt_name=a)},null,512),[[w,d.value.evt_name]])]),e("label",it,[dt,b(e("select",{class:"select select-bordered w-full","onUpdate:modelValue":t[10]||(t[10]=a=>d.value.evthm_id=a)},[rt,(l(!0),i(A,null,E(T.value,(a,h)=>(l(),i("option",{key:h,value:a.evthm_id},u(a.evthm_name),9,ut))),128))],512),[[$,d.value.evthm_id]])]),e("label",ct,[mt,b(e("input",{type:"date",class:"input input-bordered w-full","onUpdate:modelValue":t[11]||(t[11]=a=>d.value.evt_datetime=a)},null,512),[[w,d.value.evt_datetime]])]),e("label",vt,[_t,b(e("textarea",{class:"textarea w-full textarea-bordered h-96 min-h-96","onUpdate:modelValue":t[12]||(t[12]=a=>d.value.evt_description=a)},null,512),[[w,d.value.evt_description]])]),pt],32)])]),ht,e("div",ft,[e("div",bt,[e("h3",wt,"Modification de la thématique "+u(_.value.evthm_id),1),e("form",{onSubmit:j(J,["prevent"]),class:"w-full"},[e("label",gt,[yt,b(e("input",{type:"text",class:"input input-bordered w-full","onUpdate:modelValue":t[13]||(t[13]=a=>_.value.evthm_name=a)},null,512),[[w,_.value.evthm_name]])]),e("span",xt,u(_.value.evthm_name?_.value.evthm_name:"Apperçu de la thématique"),1),kt],32)])]),e("dialog",qt,[e("div",Mt,[Dt,e("div",Tt,[x.value.canDelete?(l(),i("div",Ct,At)):(l(),i("p",Et,"Vous ne pouvez pas supprimer cette thématique car elle appartient à un ou plusieurs évenements.")),e("span",Ut,u(x.value.evthm_name),1)]),x.value.canDelete?(l(),i("div",jt,[e("button",{class:"btn btn-error",onClick:C},"Annuler"),e("button",{class:"btn btn-success",onClick:t[14]||(t[14]=a=>H(x.value.evthm_name,x.value.evthm_id))},"Confirmer")])):(l(),i("div",Vt,[e("button",{class:"btn btn-error",onClick:C},"Annuler")]))])],512),e("dialog",Bt,[e("div",zt,[$t,e("div",Lt,[It,e("div",Nt,[e("div",null,[e("span",{class:L([z(y.value.evt_datetime),"badge badge-info mr-2"])},u(B(y.value.evt_datetime)),3),y.value.theme?(l(),i("span",Pt,u(y.value.theme.evthm_name),1)):M("",!0)]),e("strong",null,u(y.value.evt_name),1)])]),e("div",Ot,[e("button",{class:"btn btn-error",onClick:C},"Annuler"),e("button",{class:"btn btn-success",onClick:t[15]||(t[15]=a=>G(y.value.evt_name,y.value.evt_id))},"Confirmer")])])],512)])])}}},Gt=Q(Ft,[["__scopeId","data-v-632134fa"]]);export{Gt as default};
